(this["webpackJsonpisct-group"]=this["webpackJsonpisct-group"]||[]).push([[97],{3119:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return te}));var s=a(680),n=a(13),o=a(39),i=a(169),r=a(695),c=a(696),l=a(922),d=a(700),h=a(699),u=a(1),m=a.n(u),j=a(1210),b=a.n(j),f=a(637),p=a.n(f),O=a(89),x=a(738),g=a(3025),v=a(3048),y=a(3050),S=a(933),w=a.n(S),k=a(2682),N=a(722),C=a(930),I=(a(1078),a(1079)),T=a(1080),M=a(1081),A=a(1082),P=a(1083),J=a(1084),W=a(115);function F(){var e=Object(x.a)(["\n  flex: 1 1 0;\n  display: flex;\n  flex-direction: column;\n\n  .text-container {\n    min-height: 50px;\n\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border: solid 2px black;\n    .text {\n      font-size: 30px;\n    }\n  }\n\n  "," {\n    flex: 1;\n  }\n   "," {\n      flex: 1;\n    }\n     "," {\n        flex: 1;\n      }\n       "," {\n          flex: 1;\n        }\n         "," {\n            flex: 1;\n          }\n           "," {\n              flex: 1;\n            }\n             "," {\n                flex: 1;\n              }\n"]);return F=function(){return e},e}function B(){var e=Object(x.a)(["\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n"]);return B=function(){return e},e}var R=Object(g.a)({root:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},header:{display:"flex",alignItems:"center",padding:"0.5rem"},spacer:{flexGrow:1},body:{padding:"0.5rem",flexGrow:1}}),_=N.a.div(B()),z=N.a.div(F(),C.a,M.a,J.a,P.a,T.a,A.a,I.a);function E(e){var t,a=e.id,s=e.type,o=e.title,i=e.onRemoveItem,r=(e.component,e.workflowMaster),c=e.kpi,l=Object(u.useState)(300),d=Object(O.a)(l,2),h=(d[0],d[1],Object(u.useState)(200)),m=Object(O.a)(h,2),j=m[0],b=(m[1],Object(u.useState)([])),f=Object(O.a)(b,2),p=f[0],x=f[1],g=Object(u.useState)(JSON.parse(localStorage.getItem("domain_data")).domainName),S=Object(O.a)(g,2),N=S[0],C=(S[1],R());return Object(u.useEffect)((function(){if(null!==c){var e="",t="";e="string"===typeof c?c:c.value,t="string"===typeof r?r:r.value;var a={method:"POST",headers:{"X-Tenant":N,"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("Authorization")},body:JSON.stringify({workflowMasterId:t,domainName:N,kpiId:e})};fetch(W.j+"/api/indicator/getById",a).then((function(e){return new Promise((function(t,a){e.text().then((function(e){t(e.length?JSON.parse(e):null)})).catch((function(e){a(e)}))}))})).then((function(e){console.log(e);var t=[];e.map((function(e){t.push({data:[e.y],name:new Date(e.x).getMonth()+1+"-"+new Date(e.x).getFullYear()})})),x(t)}))}}),[]),"Line"===s?t=Object(n.jsx)(M.b,{data:p,workflowMasterName:r.label}):"Bar"===s?t=Object(n.jsx)(T.b,{data:p,workflowMasterName:r.label}):"Spline"===s?t=Object(n.jsx)(A.b,{data:p,workflowMasterName:r.label}):"Column"===s?t=Object(n.jsx)(J.b,{data:p,workflowMasterName:r.label}):"Pie"===s?t=Object(n.jsx)(P.b,{data:p,workflowMasterName:r.label}):"Variwide"===s&&(t=Object(n.jsx)(I.b,{data:p,workflowMasterName:r.label})),Object(n.jsxs)(v.a,{className:C.root,children:[Object(n.jsxs)("div",{className:C.header,style:{backgroundColor:"#E4E6E8",height:"40px"},children:[Object(n.jsx)(k.a,{variant:"h6",gutterBottom:!0,children:o}),Object(n.jsx)("div",{className:C.spacer}),Object(n.jsx)(y.a,{"aria-label":"delete",onClick:function(){return i(a)},children:Object(n.jsx)(w.a,{fontSize:"small"})})]}),Object(n.jsx)("div",{className:C.body,children:Object(n.jsx)(_,{children:Object(n.jsx)(z,{height:j,children:t})})})]},a)}a(1496);var H=a(658),L=a(743),U=a(697),D=a(704),V=a(679),G=a(689),X=(a(685),a(686),a(687),a(688),a(633)),K=Object(j.WidthProvider)(b.a),Y=[],q=[],Q=[],Z=[],$=[],ee=[],te=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var s;Object(r.a)(this,a),(s=t.call(this,e)).menu=m.a.createRef(),s.onLayoutChange=s.onLayoutChange.bind(Object(l.a)(s)),s.selectWorklfowMaster=s.selectWorklfowMaster.bind(Object(l.a)(s)),s.handleFormSubmit=s.handleFormSubmit.bind(Object(l.a)(s)),s.state={layout:JSON.parse(JSON.stringify(Y)),items:JSON.parse(JSON.stringify(q)),initialLoad:!0,newCounter:0,workflowMaster:"",titles:JSON.parse(JSON.stringify(Q)),title:"",performanceIndicators:[],selectedPerformanceIndicator:{},chartTypes:[{value:"Line",label:"Ligne"},{value:"Bar",label:"Bar"},{value:"Variwide",label:"Vari\xe9"},{value:"Column",label:"Colonne"},{value:"Spline",label:"Spline"},{value:"Pie",label:"Pie"}],dashboardName:"",roles:[],admin:[],selectedUsers:[],users:[],userRoles:[],selectedType:"",worklfowMasters:[],selectedWorkflowMaster:{},selectedTypes:JSON.parse(JSON.stringify(Z)),selectedWorkflowMasters:JSON.parse(JSON.stringify($)),selectedPerformanceIndicators:JSON.parse(JSON.stringify(ee)),domainId:JSON.parse(localStorage.getItem("domain_data")).domainId,domainName:JSON.parse(localStorage.getItem("domain_data")).domainName,position:"center"};var n=JSON.parse(localStorage.getItem("domain_data")).domainId,o={method:"POST",headers:{"X-Tenant":JSON.parse(localStorage.getItem("domain_data")).domainName,"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("Authorization")},body:JSON.stringify({domainId:n})};return fetch(W.w+"/api/workflowMaster/getAll",o).then((function(e){return new Promise((function(t,a){e.text().then((function(e){t(e.length?JSON.parse(e):null)})).catch((function(e){a(e)}))}))})).then((function(e){console.log(e);var t=[];e.map((function(e){t.push({value:e.id,label:e.name})})),s.setState({worklfowMasters:t})})),fetch(W.v+"/api/auth/role/getRoles").then((function(e){return e.json()})).then((function(e){console.log(e);var t=[];e.map((function(e){t.push({value:e.roleName,label:e.roleName})})),s.setState({userRoles:t})})).catch((function(e){console.log(e)})),fetch(W.v+"/api/auth/user/getUsersByDomain/"+n).then((function(e){return new Promise((function(t,a){e.text().then((function(e){t(e.length?JSON.parse(e):null)})).catch((function(e){a(e)}))}))})).then((function(e){console.log(e);var t=[];e.map((function(e){t.push({value:e.userId,label:e.firstName+" "+e.lastName})})),s.setState({users:t})})),s.onClick=s.onClick.bind(Object(l.a)(s)),s.onAddItem=s.onAddItem.bind(Object(l.a)(s)),s.onBreakpointChange=s.onBreakpointChange.bind(Object(l.a)(s)),s.items=[{label:"Ajouter un chart",icon:"pi pi-plus",command:function(){s.onClick("displayMaximizable")}}],s}return Object(c.a)(a,[{key:"onClick",value:function(e,t){var a=Object(i.a)({},"".concat(e),!0);t&&(a=Object(o.a)(Object(o.a)({},a),{},{position:t})),this.setState(a)}},{key:"onHide",value:function(e){console.log(this.state.selectedType),this.setState(Object(i.a)({},"".concat(e),!1))}},{key:"onSubmit",value:function(e){console.log(this.state.selectedType),this.onAddItem(),this.setState(Object(i.a)({},"".concat(e),!1))}},{key:"renderFooter",value:function(e){var t=this;return Object(n.jsxs)("div",{children:[Object(n.jsx)(H.Button,{label:"Soumettre",icon:"pi pi-check",onClick:function(){return t.onSubmit(e)},autoFocus:!0}),Object(n.jsx)(H.Button,{label:"Annuler",icon:"pi pi-times",onClick:function(){return t.onHide(e)},className:"p-button-text"})]})}},{key:"createElement",value:function(e,t){var a=this,s=e.i,o=this.state.selectedTypes[Number(s)].value,i=this.state.titles[Number(s)],r=this.state.selectedWorkflowMasters[Number(s)],c=this.state.selectedPerformanceIndicators[Number(s)];return Object(n.jsx)("div",{"data-grid":e,children:Object(n.jsx)(E,{id:s,workflowMaster:r,kpi:c,type:o,title:i,onRemoveItem:function(e){a.onRemoveItem(e)}})},s)}},{key:"onAddItem",value:function(){console.log("adding","n"+this.state.newCounter),this.setState({items:this.state.items.concat({i:""+this.state.newCounter,x:2*this.state.items.length%(this.state.cols||12),y:1/0,w:2,h:2}),titles:[].concat(Object(s.a)(this.state.titles),[this.state.title]),selectedTypes:[].concat(Object(s.a)(this.state.selectedTypes),[this.state.selectedType]),selectedWorkflowMasters:[].concat(Object(s.a)(this.state.selectedWorkflowMasters),[this.state.selectedWorkflowMaster]),selectedPerformanceIndicators:[].concat(Object(s.a)(this.state.selectedPerformanceIndicators),[this.state.selectedPerformanceIndicator]),newCounter:this.state.newCounter+1})}},{key:"onBreakpointChange",value:function(e,t){this.setState({breakpoint:e,cols:t})}},{key:"onRemoveItem",value:function(e){var t=this.state.selectedTypes,a=this.state.selectedWorkflowMasters,s=this.state.titles,n=this.state.selectedPerformanceIndicators;t.splice(e,1);var o=this.state.newCounter;this.setState({newCounter:o-1}),this.setState({selectedTypes:t}),a.splice(e,1),this.setState({selectedWorkflowMasters:a}),s.splice(e,1),this.setState({titles:s}),n.splice(e,1),this.setState({selectedPerformanceIndicators:n}),this.setState({items:p.a.reject(this.state.items,{i:e})})}},{key:"onLayoutChange",value:function(e){this.state.items,Object(s.a)(this.state.titles),Object(s.a)(this.state.selectedTypes),this.state.newCounter;ae("items",this.state.items),ae("titles",Object(s.a)(this.state.titles)),ae("selectedTypes",Object(s.a)(this.state.selectedTypes)),ae("selectedWorkflowMasters",Object(s.a)(this.state.selectedWorkflowMasters)),ae("selectedPerformanceIndicators",Object(s.a)(this.state.selectedPerformanceIndicators)),ae("newCounter",this.state.newCounter),ae("layout",e),this.setState({layout:e})}},{key:"selectWorklfowMaster",value:function(e){var t=this;this.setState({selectedWorkflowMaster:e});var a={method:"POST",headers:{"X-Tenant":this.state.domainName,"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("Authorization")},body:JSON.stringify({workflowMasterId:e.value})};fetch(W.j+"/api/indicator/getAll",a).then((function(e){return new Promise((function(t,a){e.text().then((function(e){t(e.length?JSON.parse(e):null)})).catch((function(e){a(e)}))}))})).then((function(e){console.log(e);var a=[];e.map((function(e){a.push({value:e.id,label:e.indicator})})),t.setState({performanceIndicators:a})}))}},{key:"handleFormSubmit",value:function(e){var t=this,a=[];this.state.layout.map((function(e){a.push({h:e.h,i:e.i,static:e.static,w:e.w,x:e.x,y:e.y})}));var s={titles:this.state.titles,selectedTypes:this.state.selectedTypes,selectedWorkflowMasters:this.state.selectedWorkflowMasters,selectedPerformanceIndicators:this.state.selectedPerformanceIndicators,items:this.state.items,layout:a};console.log(this.state.admin);var n={domainName:this.state.domainName,dashboardName:this.state.dashboardName,controlAccessRoles:this.state.roles,controlAccessAdmin:this.state.admin,controlAccessUsers:this.state.selectedUsers,gridItems:s},o={method:"POST",headers:{"X-Tenant":this.state.domainName,"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("Authorization")},body:JSON.stringify(n)};fetch(W.c+"/api/dashboard/create",o).then((function(e){return new Promise((function(t,a){e.text().then((function(e){t(e.length?JSON.parse(e):null)})).catch((function(e){a(e)}))}))})).then((function(e){t.props.history.push("/admin/dashboard/list")}))}},{key:"render",value:function(){var e=this;return Object(n.jsx)(X.k,{xs:"12",sm:"12",children:Object(n.jsxs)(X.f,{children:[Object(n.jsx)(X.j,{children:Object(n.jsx)("h2",{children:"Cr\xe9er un Tableau de bord"})}),Object(n.jsx)(X.g,{children:Object(n.jsxs)(X.u,{noValidate:!0,children:[Object(n.jsxs)(X.v,{row:!0,className:"my-0",children:[Object(n.jsx)(X.k,{sm:12,md:6,children:Object(n.jsxs)(X.v,{children:[Object(n.jsx)(X.H,{htmlFor:"dashboardName",children:"Nom du Tableau de bord"}),Object(n.jsx)(X.A,{id:"dashboardName",onChange:function(t){return e.setState({dashboardName:t.target.value})},value:this.state.dashboardName})]})}),Object(n.jsx)(X.k,{sm:12,md:6,children:Object(n.jsxs)(X.v,{children:[Object(n.jsx)(X.H,{htmlFor:"AccessControlRoles",children:"Contr\xf4le d'acc\xe8s (R\xf4les)"}),Object(n.jsx)(V.a,{name:"AccessControlRoles",placeholder:"Global",value:this.state.roles,options:this.state.userRoles,onChange:function(t){return e.setState({roles:t})},isMulti:!0})]})})]}),Object(n.jsxs)(X.v,{row:!0,className:"my-0",children:[Object(n.jsx)(X.k,{sm:12,md:6,children:Object(n.jsxs)(X.v,{children:[Object(n.jsx)(X.H,{htmlFor:"AccessControlAdmin",children:"Contr\xf4le d'acc\xe8s (Admin)"}),Object(n.jsx)(V.a,{name:"AccessControlAdmin",placeholder:"Global",value:this.state.admin,options:this.state.userRoles,onChange:function(t){return e.setState({admin:t})},isMulti:!0})]})}),Object(n.jsx)(X.k,{sm:12,md:6,children:Object(n.jsxs)(X.v,{children:[Object(n.jsx)(X.H,{htmlFor:"AccessControlUser",children:"Contr\xf4le d'acc\xe8s (User)"}),Object(n.jsx)(V.a,{name:"AccessControlUser",placeholder:"Global",value:this.state.selectedUsers,options:this.state.users,onChange:function(t){return e.setState({selectedUsers:t})},isMulti:!0})]})})]}),Object(n.jsxs)(X.f,{children:[Object(n.jsxs)(X.j,{style:{backgroundColor:"#F5F5F5"},children:["Tableau de Bord",Object(n.jsx)(G.Menu,{model:this.items,popup:!0,ref:function(t){return e.menu=t},id:"popup_menu"}),Object(n.jsx)(X.I,{style:{paddingLeft:"10px"},className:"card-header-actions",children:Object(n.jsx)("i",{size:"2xl",className:"pi pi-bars",icon:"pi pi-bars",onClick:function(t){return e.menu.toggle(t)},"aria-controls":"popup_menu","aria-haspopup":!0})})]}),Object(n.jsx)(X.g,{children:Object(n.jsx)("div",{children:Object(n.jsx)(K,{layout:this.state.layout,onLayoutChange:this.onLayoutChange,onBreakpointChange:this.onBreakpointChange,children:this.state.items.map((function(t,a){return e.createElement(t,a)}))})})}),Object(n.jsx)(L.Dialog,{visible:this.state.displayMaximizable,maximizable:!0,modal:!0,style:{width:"70vw"},footer:this.renderFooter("displayMaximizable"),onHide:function(){return e.onHide("displayMaximizable")},children:Object(n.jsxs)(X.u,{noValidate:!0,children:[Object(n.jsxs)(X.v,{row:!0,className:"my-0",children:[Object(n.jsx)(X.k,{sm:12,md:12,children:Object(n.jsxs)(X.v,{children:[Object(n.jsx)(X.H,{htmlFor:"title",children:"Titre"}),Object(n.jsx)(X.A,{id:"title",onChange:function(t){return e.setState({title:t.target.value})},value:this.state.title})]})}),Object(n.jsx)(X.k,{sm:12,md:12,children:Object(n.jsxs)(X.v,{children:[Object(n.jsx)(X.H,{htmlFor:"chartType",children:"Type de chart"}),Object(n.jsx)(V.a,{name:"chartType",value:this.state.selectedType,options:this.state.chartTypes,onChange:function(t){return e.setState({selectedType:t})}})]})})]}),Object(n.jsxs)(X.v,{row:!0,className:"my-0",children:[Object(n.jsx)(X.k,{sm:12,md:12,children:Object(n.jsxs)(X.v,{children:[Object(n.jsx)(X.H,{htmlFor:"workfowMaster",children:"Ma\xeetre de flux de travail"}),Object(n.jsx)(V.a,{name:"workfowMaster",value:this.state.selectedWorkflowMaster,options:this.state.worklfowMasters,onChange:function(t){return e.selectWorklfowMaster(t)}})]})}),Object(n.jsx)(X.k,{sm:12,md:12,children:Object(n.jsxs)(X.v,{children:[Object(n.jsx)(X.H,{htmlFor:"indicator",children:"Indicateur"}),Object(n.jsx)(V.a,{name:"indicator",value:this.state.selectedPerformanceIndicator,options:this.state.performanceIndicators,onChange:function(t){return e.setState({selectedPerformanceIndicator:t})}})]})})]})]})})]}),Object(n.jsxs)(X.O,{xs:"4",children:[Object(n.jsx)(X.k,{col:"6",sm:"4",md:"2",xl:!0,className:"mb-3 mb-xl-0",children:Object(n.jsxs)(X.e,{block:!0,variant:"outline",color:"info",id:"formSave",onClick:function(t){return e.handleFormSubmit(t)},children:[Object(n.jsx)(U.a,{})," Enregister"]})}),Object(n.jsx)(X.k,{col:"6",sm:"4",md:"2",xl:!0,className:"mb-3 mb-xl-0",children:Object(n.jsxs)(X.e,{block:!0,variant:"outline",color:"danger",onClick:function(){return e.props.history.push("/admin/dashboard/list")},children:[Object(n.jsx)(D.a,{})," Annuler"]})})]})]})})]})})}}]),a}(m.a.PureComponent);function ae(e,t){localStorage&&localStorage.setItem(e,JSON.stringify(Object(i.a)({},e,t)))}te.defaultProps={className:"layout",onLayoutChange:function(){}},!0===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).STATIC_EXAMPLES&&a.e(22).then(a.bind(null,3105)).then((function(e){return e.default(te)}))}}]);
//# sourceMappingURL=97.850610b0.chunk.js.map